const e=e=>{let t=document.querySelector(".movies-list");t.innerHTML="";let o=e.map(({id:e,title:t,genre:o,director:n,year:r})=>`<li id="${e}" class="movies-item"><h3 class="movies-title">${t}</h3><p class="movies-genre">${o}</p><p class="movies-director">${n}</p><p class="movies-year">${r}</p><div class="movie-managment"><button type="button" class="button movie-button edit-button">Edit</button><button type="button" class="button movie-button edit-everything-button">Edit all</button><button type="button" class="button movie-button delete-button">Delete</button></div></li>`).join("");t.innerHTML=o},t=()=>{let t=[];for(let e of o)t.some(t=>Number(t.id)===Number(e.id))||t.push(e);o.length=0,o.push(...t),e(o)};let o=[];const n=async()=>{try{let e={title:document.querySelector(".title").value,genre:document.querySelector(".genre").value,director:document.querySelector(".director").value,year:document.querySelector(".year").value},n={method:"POST",body:JSON.stringify(e),headers:{"Content-Type":"application/json; charset=UTF-8"}};return await fetch("http://localhost:3000/movies",n).then(e=>e.json()).then(e=>{o.push(e),t()})}catch(e){console.error(e)}},r=async e=>{try{return await fetch(`http://localhost:3000/movies/${e}`,{method:"DELETE"}).then(e=>e)}catch(e){console.error(e)}return fetch(`http://localhost:3000/movies/${e}`,{method:"DELETE"}).then(e=>e).catch(e=>console.log(e))},s=()=>{document.removeEventListener("click",i),document.addEventListener("click",i)},i=async e=>{if(e.target.classList.contains("delete-button")){let t=e.target.closest(".movies-item");try{await r(t.id),t.remove()}catch(e){console.error(e)}}},c=async(e,t)=>{try{let o={method:"PUT",body:JSON.stringify(e),headers:{"Content-Type":"application/json; charset=UTF-8"}};return await fetch(`http://localhost:3000/movies/${t}`,o).then(e=>e.json()).then(e=>e)}catch(e){console.error(e)}},l=()=>{document.addEventListener("click",a)},a=e=>{if(e.target.classList.contains("edit-everything-button")){let t=document.querySelector(".backdrop-edit"),o=document.querySelector(".form-edit"),n=document.querySelector(".modal-edit-close"),r=e.target.closest(".movies-item"),s=r.dataset.id;t.classList.remove("is-hidden"),o.elements.name.value=r.querySelector(".movies-title").textContent,o.elements.genre.value=r.querySelector(".movies-genre").textContent,o.elements.director.value=r.querySelector(".movies-director").textContent,o.elements.year.value=r.querySelector(".movies-year").textContent;let i=e=>{e.preventDefault(),t.classList.add("is-hidden");let n={title:o.elements.name.value,genre:o.elements.genre.value,director:o.elements.director.value,year:o.elements.year.value};c(s,n).then(()=>{r.querySelector(".movies-title").textContent=n.title,r.querySelector(".movies-genre").textContent=n.genre,r.querySelector(".movies-director").textContent=n.director,r.querySelector(".movies-year").textContent=n.year}),o.removeEventListener("submit",i)};o.addEventListener("submit",i),n.addEventListener("click",()=>{t.classList.add("is-hidden"),o.removeEventListener("submit",i)})}},d=async(e,t)=>{try{let o={method:"PATCH",body:JSON.stringify(e),headers:{"Content-Type":"application/json; charset=UTF-8"}};return await fetch(`http://localhost:3000/movies/${t}`,o).then(e=>e.json()).then(e=>e)}catch(e){console.error(e)}},m=()=>{document.addEventListener("click",u)},u=e=>{if(e.target.classList.contains("edit-button")){let t=document.querySelector(".backdrop-edit"),o=document.querySelector(".form-edit"),n=document.querySelector(".modal-edit-close"),r=e.target.closest(".movies-item"),s=r.dataset.id;t.classList.remove("is-hidden"),o.elements.name.value=r.querySelector(".movies-title").textContent,o.elements.genre.value=r.querySelector(".movies-genre").textContent,o.elements.director.value=r.querySelector(".movies-director").textContent,o.elements.year.value=r.querySelector(".movies-year").textContent;let i=e=>{e.preventDefault(),t.classList.add("is-hidden");let n={title:o.elements.name.value,genre:o.elements.genre.value,director:o.elements.director.value,year:o.elements.year.value};d(s,n).then(()=>{r.querySelector(".movies-title").textContent=n.title,r.querySelector(".movies-genre").textContent=n.genre,r.querySelector(".movies-director").textContent=n.director,r.querySelector(".movies-year").textContent=n.year}),o.removeEventListener("submit",i)};o.addEventListener("submit",i),n.addEventListener("click",()=>{t.classList.add("is-hidden"),o.removeEventListener("submit",i)})}};(async()=>{try{return await fetch("http://localhost:3000/movies").then(e=>e.json()).then(n=>{o.push(...n),e(n),m(),l(),s(),t()})}catch(e){console.error(e)}})(),(async()=>{document.querySelector(".add-movie").addEventListener("click",async()=>{try{await n()}catch(e){console.error(e)}})})(),(()=>{let e=document.querySelector(".get-movies"),t=document.querySelector(".hide-movies"),o=document.querySelector(".movies-list");e.addEventListener("click",()=>{o.classList.remove("is-hidden")}),t.addEventListener("click",()=>{o.classList.add("is-hidden")})})(),(()=>{let e=document.querySelector(".hide-movies"),t=document.querySelector(".movies-list");e.addEventListener("click",()=>{t.classList.add("is-hidden")})})();
//# sourceMappingURL=index.bba69d47.js.map
